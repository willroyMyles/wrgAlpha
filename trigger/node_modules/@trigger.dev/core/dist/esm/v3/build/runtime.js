import { join } from "node:path";
import { pathToFileURL } from "url";
export const DEFAULT_RUNTIME = "node";
export function binaryForRuntime(runtime) {
    switch (runtime) {
        case "node":
            return "node";
        case "bun":
            return "bun";
        default:
            throw new Error(`Unsupported runtime ${runtime}`);
    }
}
export function execPathForRuntime(runtime) {
    switch (runtime) {
        case "node":
            return process.execPath;
        case "bun":
            if (typeof process.env.BUN_INSTALL === "string") {
                return join(process.env.BUN_INSTALL, "bin", "bun");
            }
            if (typeof process.env.BUN_INSTALL_BIN === "string") {
                return join(process.env.BUN_INSTALL_BIN, "bun");
            }
            return join("~", ".bin", "bin", "bun");
        default:
            throw new Error(`Unsupported runtime ${runtime}`);
    }
}
export function execOptionsForRuntime(runtime, options) {
    switch (runtime) {
        case "node": {
            const importEntryPoint = options.loaderEntryPoint
                ? `--import=${pathToFileURL(options.loaderEntryPoint).href}`
                : undefined;
            const conditions = options.customConditions?.map((condition) => `--conditions=${condition}`);
            return [importEntryPoint, conditions, process.env.NODE_OPTIONS]
                .filter(Boolean)
                .flat()
                .join(" ");
        }
        case "bun": {
            return "";
        }
    }
}
//# sourceMappingURL=runtime.js.map